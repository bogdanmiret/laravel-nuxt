(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{239:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return d}));var n=r(648),o=r(0),c=Object(o.i)("v-card__actions"),l=Object(o.i)("v-card__subtitle"),m=Object(o.i)("v-card__text"),d=Object(o.i)("v-card__title");n.a},676:function(e,t,r){"use strict";r(175);var n=r(176);t.a=Object(n.a)("flex")},677:function(e,t,r){"use strict";r(175);var n=r(176);t.a=Object(n.a)("layout")},738:function(e,t,r){"use strict";r(11),r(8),r(7),r(4),r(9);var n=r(55),o=(r(34),r(3)),c=r(1),l=r(35),m=r(15);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=null,v={props:{value:Object,handler:Function,validateOnStart:Boolean,socAuth:Boolean,captchaLoaded:Boolean},mixins:[],data:function(){return{form:{email:null,nickname:null,password:null},loading:!1,passwordShow:!1,nicknameUnique:null,nicknameCheckLoading:!1,passwordVariantAuthChoose:null,enterEmail:null}},methods:f({submit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.form,!1===e.passwordVariantAuthChoose&&(n=e.form.nickname,r={nickname:n}),t.next=4,e.validateByMixin(r);case 4:if(!t.sent){t.next=15;break}if(o=null,!window.grecaptcha){t.next=11;break}if(o=window.grecaptcha.getResponse()){t.next=11;break}return m.c.error("Подтвердите что Вы не робот."),t.abrupt("return");case 11:return e.loading=!0,t.next=14,e.handler(o);case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t)})))()},checkNickname:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.nicknameCheckLoading=!0,clearTimeout(h),h=setTimeout(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkNicknameUnique(e.form.nickname);case 2:e.nicknameUnique=t.sent,e.nicknameCheckLoading=!1;case 4:case"end":return t.stop()}}),t)}))),1e3);case 3:case"end":return t.stop()}}),t)})))()},input:function(){this.$emit("input",{data:this.form,btnDisabled:this.btnDisabled,passwordVariantAuthChoose:this.passwordVariantAuthChoose})},setFormFromValue:function(){this.form=f({},this.form,{},this.value.data)}},Object(l.b)("auth",["checkNicknameUnique"])),computed:{nicknameErrors:function(){var e=this.errors.collect("nickname");return!1===this.nicknameUnique&&e.push("Занятый"),e},btnDisabled:function(){return!(![].concat(Object(n.a)(this.errors.items),Object(n.a)(this.nicknameErrors)).length&&!this.nicknameCheckLoading)}},watch:{form:{deep:!0,handler:function(){this.input()}},errors:function(){this.input()},btnDisabled:function(){this.input()},passwordVariantAuthChoose:function(){this.input()}},mounted:function(){return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},k=r(32),w=r(38),O=r.n(w),y=r(666),j=r(101),x=r(677),_=r(165),S=r(652),component=Object(k.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"px-3"},[r("v-text-field",{attrs:{"error-messages":e.nicknameErrors,loading:e.nicknameCheckLoading,"data-vv-name":"nickname","prepend-icon":"person",label:"Ник",required:""},on:{input:e.checkNickname},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}}),e._v(" "),e.form.nickname&&!e.errors.has("nickname")?[r("v-alert",{attrs:{value:e.nicknameCheckLoading,color:"info",icon:"info",outline:""}},[e._v("\n      Checking...\n      "),r("v-progress-circular",{attrs:{color:"primary",size:20,indeterminate:""}})],1),e._v(" "),e.nicknameCheckLoading?e._e():[r("v-alert",{attrs:{value:e.nicknameUnique,color:"success",icon:"check_circle",outline:""}},[e._v("\n        Nickname is available\n      ")])]]:e._e(),e._v(" "),e.socAuth?e._e():r("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Email",type:"email","error-messages":e.errors.collect("email"),"data-vv-name":"email",required:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._v(" "),e.socAuth?e._e():r("v-text-field",{attrs:{"error-messages":e.errors.collect("password"),type:e.passwordShow?"text":"password","append-icon":e.passwordShow?"visibility_off":"visibility","data-vv-name":"password",label:"Password",required:""},on:{"click:append":function(t){e.passwordShow=!e.passwordShow}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),e.socAuth?e._e():r("v-layout",{staticClass:"mt-4",attrs:{"justify-center":""}}),e._v(" "),r("v-btn",{staticClass:"mt-5",attrs:{color:"primary",loading:e.loading,disabled:e.btnDisabled,large:"",block:""},on:{click:e.submit}},[e._v("\n    Submit\n  ")])],2)}),[],!1,null,null,null);t.a=component.exports;O()(component,{VAlert:y.a,VBtn:j.a,VLayout:x.a,VProgressCircular:_.a,VTextField:S.a})},954:function(e,t,r){"use strict";r.r(t);r(11),r(8),r(7),r(4),r(9),r(34);var n=r(3),o=r(1),c=r(35);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var m={components:{SignupForm:r(738).a},data:function(){return{form:{},userSocResponse:null,haveEmail:null,saveSocAccLoading:!1}},methods:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({submitNewUser:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var data,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return data=e.form.data,t.next=3,e.signup({form:data,userSoc:e.user,providerName:e.providerName});case 3:return r=t.sent,t.next=6,e.signinManually(r);case 6:e.$notify.success("Аккаунт создан через ".concat(e.providerName,"."));case 7:case"end":return t.stop()}}),t)})))()},justSignIn:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.userSocResponse.doAuth,t.next=3,e.signinManually(r);case 3:e.$notify.success("Вход через ".concat(e.providerName," выполнен.")),e.$router.push("/profile/"+r.user.nickname);case 5:case"end":return t.stop()}}),t)})))()},checkAccessDenied:function(){var e=this.$route.query.error;e&&("access_denied"===e?(this.$notify.error("Доступ отклонен"),this.$router.push(this.$auth.loggedIn?"/profile/settings/soc-accounts":"/auth/signin")):this.$notify.error(e))}},Object(c.b)("authSocialite",["getUserSocialite","saveSocAcc"]),{},Object(c.b)("auth",["signup","signinManually"])),computed:{code:function(){return this.$route.query.code},providerName:function(){return this.$route.params.providerName},user:function(){return this.userSocResponse&&this.userSocResponse.user}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,code,n,o,c,l,m,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.checkAccessDenied(),r=e.providerName,code=e.code,n={code:code,providerName:r,loggedIn:e.$auth.loggedIn},t.prev=4,t.next=7,e.getUserSocialite(n);case 7:if(e.userSocResponse=t.sent,!e.$auth.loggedIn){t.next=14;break}return e.saveSocAccLoading=!0,t.next=12,e.saveSocAcc({userSoc:e.user,providerName:r});case 12:t.next=15;break;case 14:e.userSocResponse.doAuth?e.justSignIn():(o=e.user,c=o.email,l=o.nickname,e.form.data={email:c,nickname:l},e.haveEmail=!!c);case 15:t.next=22;break;case 17:t.prev=17,t.t0=t.catch(4),m=t.t0.response,401!==(d=m.status)&&400!==d||(e.$notify.error(m.data.message),e.$router.push(e.$auth.loggedIn?"/profile/settings/soc-accounts":"/auth/signin"));case 22:case"end":return t.stop()}}),t,null,[[4,17]])})))()}},d=r(32),f=r(38),h=r.n(f),v=r(666),k=r(648),w=r(239),O=r(669),y=r(676),j=r(677),component=Object(d.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"fill-height":""}},[r("v-alert",{staticClass:"display-1 text-xs-center",attrs:{value:!e.user||e.saveSocAccLoading,type:"info"}},[e.user?e._e():[e._v("\n      Получаем данные о Вас...\n    ")],e._v(" "),e.saveSocAccLoading?[e._v("\n      Сохраняем в ваши прикрепленные аккаунты...\n    ")]:e._e()],2),e._v(" "),e.$auth.loggedIn||!e.user||e.userSocResponse.doAuth?e._e():r("v-layout",{attrs:{"fill-height":"","justify-center":"","align-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg4:"",xl3:""}},[r("v-card",{staticClass:"elevation-10"},[r("v-card-text",[r("div",{staticClass:"display-1 text-xs-center mb-3"},[e._v("\n            Последний шаг\n          ")]),e._v(" "),r("form",{attrs:{autocomplete:"on"},on:{submit:function(t){return t.preventDefault(),e.submitNewUser(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitNewUser(t)}}},[r("signup-form",{attrs:{handler:e.submitNewUser,"soc-auth":"","validate-on-start":""},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;h()(component,{VAlert:v.a,VCard:k.a,VCardText:w.b,VContainer:O.a,VFlex:y.a,VLayout:j.a})}}]);