exports.ids=[6],exports.modules={101:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return h}));var r=n(457),o=n(0);const c=Object(o.i)("v-card__actions"),l=Object(o.i)("v-card__subtitle"),d=Object(o.i)("v-card__text"),h=Object(o.i)("v-card__title");r.a},482:function(e,t,n){"use strict";n(76);var r=n(77);t.a=Object(r.a)("layout")},484:function(e,t,n){"use strict";n(76);var r=n(77);t.a=Object(r.a)("flex")},538:function(e,t,n){"use strict";var r=n(11),o=n(7);let c=null;var l={props:{value:Object,handler:Function,validateOnStart:Boolean,socAuth:Boolean,captchaLoaded:Boolean},mixins:[],data:()=>({form:{email:null,nickname:null,password:null},loading:!1,passwordShow:!1,nicknameUnique:null,nicknameCheckLoading:!1,passwordVariantAuthChoose:null,enterEmail:null}),methods:{async submit(){let e=this.form;if(!1===this.passwordVariantAuthChoose){const{nickname:t}=this.form;e={nickname:t}}if(await this.validateByMixin(e)){let e=null;if(window.grecaptcha&&(e=window.grecaptcha.getResponse(),!e))return void o.c.error("Подтвердите что Вы не робот.");this.loading=!0,await this.handler(e),this.loading=!1}},async checkNickname(){this.nicknameCheckLoading=!0,clearTimeout(c),c=setTimeout(async()=>{this.nicknameUnique=await this.checkNicknameUnique(this.form.nickname),this.nicknameCheckLoading=!1},1e3)},input(){this.$emit("input",{data:this.form,btnDisabled:this.btnDisabled,passwordVariantAuthChoose:this.passwordVariantAuthChoose})},setFormFromValue(){this.form={...this.form,...this.value.data}},...Object(r.mapActions)("auth",["checkNicknameUnique"])},computed:{nicknameErrors(){let e=this.errors.collect("nickname");return!1===this.nicknameUnique&&e.push("Занятый"),e},btnDisabled(){return!(![...this.errors.items,...this.nicknameErrors].length&&!this.nicknameCheckLoading)}},watch:{form:{deep:!0,handler(){this.input()}},errors(){this.input()},btnDisabled(){this.input()},passwordVariantAuthChoose(){this.input()}},async mounted(){}},d=n(10),h=n(12),m=n.n(h),v=n(477),f=n(37),k=n(482),w=n(69),y=n(462),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"px-3"},[n("v-text-field",{attrs:{"error-messages":e.nicknameErrors,loading:e.nicknameCheckLoading,"data-vv-name":"nickname","prepend-icon":"person",label:"Ник",required:""},on:{input:e.checkNickname},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}}),e._ssrNode(" "),e.form.nickname&&!e.errors.has("nickname")?[n("v-alert",{attrs:{value:e.nicknameCheckLoading,color:"info",icon:"info",outline:""}},[e._v("\n      Checking...\n      "),n("v-progress-circular",{attrs:{color:"primary",size:20,indeterminate:""}})],1),e._ssrNode(" "),e.nicknameCheckLoading?e._e():[n("v-alert",{attrs:{value:e.nicknameUnique,color:"success",icon:"check_circle",outline:""}},[e._v("\n        Nickname is available\n      ")])]]:e._e(),e._ssrNode(" "),e.socAuth?e._e():n("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Email",type:"email","error-messages":e.errors.collect("email"),"data-vv-name":"email",required:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._ssrNode(" "),e.socAuth?e._e():n("v-text-field",{attrs:{"error-messages":e.errors.collect("password"),type:e.passwordShow?"text":"password","append-icon":e.passwordShow?"visibility_off":"visibility","data-vv-name":"password",label:"Password",required:""},on:{"click:append":function(t){e.passwordShow=!e.passwordShow}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._ssrNode(" "),e.socAuth?e._e():n("v-layout",{staticClass:"mt-4",attrs:{"justify-center":""}}),e._ssrNode(" "),n("v-btn",{staticClass:"mt-5",attrs:{color:"primary",loading:e.loading,disabled:e.btnDisabled,large:"",block:""},on:{click:e.submit}},[e._v("\n    Submit\n  ")])],2)}),[],!1,null,null,"4b6cebdb");t.a=component.exports;m()(component,{VAlert:v.a,VBtn:f.a,VLayout:k.a,VProgressCircular:w.a,VTextField:y.a})},605:function(e,t,n){"use strict";n.r(t);var r=n(11),o={components:{SignupForm:n(538).a},data:()=>({form:{},userSocResponse:null,haveEmail:null,saveSocAccLoading:!1}),methods:{async submitNewUser(){const{data:data}=this.form,e=await this.signup({form:data,userSoc:this.user,providerName:this.providerName});await this.signinManually(e),this.$notify.success(`Аккаунт создан через ${this.providerName}.`)},async justSignIn(){const e=this.userSocResponse.doAuth;await this.signinManually(e),this.$notify.success(`Вход через ${this.providerName} выполнен.`),this.$router.push("/profile/"+e.user.nickname)},checkAccessDenied(){const e=this.$route.query.error;e&&("access_denied"===e?(this.$notify.error("Доступ отклонен"),this.$router.push(this.$auth.loggedIn?"/profile/settings/soc-accounts":"/auth/signin")):this.$notify.error(e))},...Object(r.mapActions)("authSocialite",["getUserSocialite","saveSocAcc"]),...Object(r.mapActions)("auth",["signup","signinManually"])},computed:{code(){return this.$route.query.code},providerName(){return this.$route.params.providerName},user(){return this.userSocResponse&&this.userSocResponse.user}},async mounted(){this.checkAccessDenied();const e=this.providerName,t={code:this.code,providerName:e,loggedIn:this.$auth.loggedIn};try{if(this.userSocResponse=await this.getUserSocialite(t),this.$auth.loggedIn)this.saveSocAccLoading=!0,await this.saveSocAcc({userSoc:this.user,providerName:e});else if(this.userSocResponse.doAuth)this.justSignIn();else{const{email:e,nickname:t}=this.user;this.form.data={email:e,nickname:t},this.haveEmail=!!e}}catch({response:e}){const t=e.status;401!==t&&400!==t||(this.$notify.error(e.data.message),this.$router.push(this.$auth.loggedIn?"/profile/settings/soc-accounts":"/auth/signin"))}}},c=n(10),l=n(12),d=n.n(l),h=n(477),m=n(457),v=n(101),f=n(478),k=n(484),w=n(482),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"fill-height":""}},[n("v-alert",{staticClass:"display-1 text-xs-center",attrs:{value:!e.user||e.saveSocAccLoading,type:"info"}},[e.user?e._e():[e._v("\n      Получаем данные о Вас...\n    ")],e._v(" "),e.saveSocAccLoading?[e._v("\n      Сохраняем в ваши прикрепленные аккаунты...\n    ")]:e._e()],2),e._v(" "),e.$auth.loggedIn||!e.user||e.userSocResponse.doAuth?e._e():n("v-layout",{attrs:{"fill-height":"","justify-center":"","align-center":""}},[n("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg4:"",xl3:""}},[n("v-card",{staticClass:"elevation-10"},[n("v-card-text",[n("div",{staticClass:"display-1 text-xs-center mb-3"},[e._v("\n            Последний шаг\n          ")]),e._v(" "),n("form",{attrs:{autocomplete:"on"},on:{submit:function(t){return t.preventDefault(),e.submitNewUser(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitNewUser(t)}}},[n("signup-form",{attrs:{handler:e.submitNewUser,"soc-auth":"","validate-on-start":""},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)])],1)],1)],1)],1)}),[],!1,null,null,"4f0ca5be");t.default=component.exports;d()(component,{VAlert:h.a,VCard:m.a,VCardText:v.b,VContainer:f.a,VFlex:k.a,VLayout:w.a})}};